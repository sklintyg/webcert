apply plugin: 'com.netflix.nebula.grunt'
apply plugin: 'idea'

idea {
    module {
        excludeDirs += file('node_modules')
    }
}

grunt {
    colors = System.properties['gruntColors'] ? System.properties['gruntColors'].toBoolean() : true
}

node {
    version = "${nodeJsVersion}"
    npmVersion = "${npmVersion}"
    download = true
    distBaseUrl = 'https://nodejs.org/dist/'
    workDir = file("${rootProject.projectDir}/.gradle/nodejs")
    npmWorkDir = file("${rootProject.projectDir}/.gradle/npm")
}

tasks.register('protractorTests', NodeTask) {
    dependsOn npmInstall
    outputs.upToDateWhen { false }
    def environment = System.properties['protractor.env'] ?: "dev"

    script = file('node_modules/grunt-cli/bin/grunt')
    args = ["default:${environment}", "--headless"]
}

dependencies {
    runtimeOnly project(':webcert-web')
}
